{"version":3,"sources":["../../../projects/mat-select-filter/src/lib/mat-select-filter.service.ts","../../../projects/mat-select-filter/src/lib/mat-select-filter.component.ts","../../../projects/mat-select-filter/src/lib/mat-select-filter.module.ts"],"names":["Injectable","args","providedIn","MatSelectFilterComponent","fb","this","showSpinner","noResultsMessage","noResults","localSpinner","filteredReturn","EventEmitter","filteredItems","searchForm","group","value","prototype","ngOnInit","_this","searchFormValueChangesSubscription","valueChanges","subscribe","displayMember","array","filter","name","toLowerCase","includes","hasGroup","groupArrayName","map","a","objCopy","Object","assign","g","x","length","slice","emit","setTimeout","input","nativeElement","focus","placeholder","handleKeydown","event","key","keyCode","A","Z","ZERO","NINE","SPACE","stopPropagation","ngOnDestroy","unsubscribe","Component","selector","template","FormBuilder","ViewChild","static","Input","Output","NgModule","declarations","imports","CommonModule","FormsModule","ReactiveFormsModule","MatProgressSpinnerModule","exports"],"mappings":"8nBAOE,4HALDA,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,kEC4CZ,SAAAC,EAAYC,GAbUC,KAAAC,aAAc,EACTD,KAAAE,iBAAmB,aAI9CF,KAAAG,WAAY,EAEZH,KAAAI,cAAe,EACLJ,KAAAK,eAAiB,IAAIC,EAAAA,aAExBN,KAAAO,cAAqB,GAI1BP,KAAKQ,WAAaT,EAAGU,MAAM,CACzBC,MAAO,YAIXZ,EAAAa,UAAAC,SAAA,WAAA,IAAAC,EAAAb,KACEA,KAAKc,mCAAsCd,KAAKQ,WAAWO,aAAaC,WAAU,SAAAN,GAC5EG,EAAKZ,cACPY,EAAKT,cAAe,GAElBM,EAAa,OAEW,MAAtBG,EAAKI,cACPJ,EAAKN,cAAgBM,EAAKK,MAAMC,QAAO,SAAAC,GAAQ,OAAAA,EAAKC,cAAcC,SAASZ,EAAa,MAAEW,kBAEjFR,EAAKU,UAAYV,EAAKW,gBAAkBX,EAAKI,cACtDJ,EAAKN,cAAgBM,EAAKK,MAAMO,KAAI,SAAAC,GAClC,IAAMC,EAAUC,OAAOC,OAAO,GAAIH,GAElC,OADAC,EAAQd,EAAKW,gBAAkBG,EAAQd,EAAKW,gBAAgBL,QAAO,SAAAW,GAAK,OAAAA,EAAEjB,EAAKI,eAAeI,cAAcC,SAASZ,EAAa,MAAEW,kBAC7HM,KACNR,QAAO,SAAAY,GAAK,OAAAA,EAAElB,EAAKW,gBAAgBQ,OAAS,KAE/CnB,EAAKN,cAAgBM,EAAKK,MAAMC,QAAO,SAAAC,GAAQ,OAAAA,EAAKP,EAAKI,eAAeI,cAAcC,SAASZ,EAAa,MAAEW,kBAIhHR,EAAKV,UAAkC,MAAtBU,EAAKN,eAAuD,IAA9BM,EAAKN,cAAcyB,SAIlEnB,EAAKN,cAAgBM,EAAKK,MAAMe,QAChCpB,EAAKV,WAAY,GAEnBU,EAAKR,eAAe6B,KAAKrB,EAAKN,eAC9B4B,YAAW,WACLtB,EAAKZ,cACPY,EAAKT,cAAe,KAErB,QAGL+B,YAAW,WACTtB,EAAKuB,MAAMC,cAAcC,UACxB,KACEtC,KAAKuC,cACRvC,KAAKuC,YAAc,cAIvBzC,EAAAa,UAAA6B,cAAA,SAAcC,IAEPA,EAAMC,KAA4B,IAArBD,EAAMC,IAAIV,QACzBS,EAAME,SAAWC,EAAAA,GAAKH,EAAME,SAAWE,EAAAA,GACvCJ,EAAME,SAAWG,EAAAA,MAAQL,EAAME,SAAWI,EAAAA,MAC1CN,EAAME,UAAYK,EAAAA,QACnBP,EAAMQ,mBAGVnD,EAAAa,UAAAuC,YAAA,WACElD,KAAKK,eAAe6B,KAAKlC,KAAKkB,OAC9BlB,KAAKc,mCAAmCqC,wCAlG3CC,EAAAA,UAASxD,KAAA,CAAC,CACTyD,SAAU,oBACVC,SAAU,4+BAXQC,EAAAA,8CA2BjBC,EAAAA,UAAS5D,KAAA,CAAC,QAAS,CAAE6D,QAAQ,mBAE7BC,EAAAA,MAAK9D,KAAA,CAAC,8BACN8D,EAAAA,MAAK9D,KAAA,CAAC,8BACN8D,EAAAA,MAAK9D,KAAA,CAAC,gCACN8D,EAAAA,MAAK9D,KAAA,CAAC,sCACN8D,EAAAA,MAAK9D,KAAA,CAAC,yCACN8D,EAAAA,MAAK9D,KAAA,CAAC,sCACN8D,EAAAA,MAAK9D,KAAA,CAAC,oCACN8D,EAAAA,MAAK9D,KAAA,CAAC,0CAKN+D,EAAAA,gBC3BH,iCAVCC,EAAAA,SAAQhE,KAAA,CAAC,CACRiE,aAAc,CAAC/D,GACfgE,QAAS,CACPC,EAAAA,aACAC,EAAAA,YACAC,EAAAA,oBACAC,EAAAA,0BAEFC,QAAS,CAACrE","sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MatSelectFilterService {\n\n  constructor() { }\n}\n","import { Component, OnInit, Input, EventEmitter, Output, ViewChild, OnDestroy } from '@angular/core';\nimport { FormGroup, FormBuilder } from '@angular/forms';\nimport {\n  A,\n  Z,\n  ZERO,\n  NINE,\n  SPACE, END, HOME,\n} from '@angular/cdk/keycodes';\nimport { Subscription } from 'rxjs';\n@Component({\n  selector: 'mat-select-filter',\n  template: `\n  <form [formGroup]=\"searchForm\" class=\"mat-filter\" [ngStyle]=\"{'background-color': color ? color : 'white'}\">\n  <div>\n  <input #input class=\"mat-filter-input\" matInput placeholder=\"{{placeholder}}\" formControlName=\"value\" (keydown)=\"handleKeydown($event)\">\n    <mat-spinner *ngIf=\"localSpinner\" class=\"spinner\" diameter=\"16\"></mat-spinner>\n  </div>\n  <div *ngIf=\"noResults\"\n     class=\"noResultsMessage\">\n  {{noResultsMessage}}\n</div>\n</form>\n  `,\n  styleUrls: ['./mat-select-filter.component.scss']\n})\nexport class MatSelectFilterComponent implements OnInit, OnDestroy {\n  private searchFormValueChangesSubscription: Subscription;\n  @ViewChild('input', { static: true }) input;\n\n  @Input('array') array: any;\n  @Input('placeholder') placeholder: string;\n  @Input('color') color: string;\n  @Input('displayMember') displayMember: string;\n  @Input('showSpinner') showSpinner = true;\n  @Input('noResultsMessage') noResultsMessage = 'No results';\n  @Input('hasGroup') hasGroup: boolean;\n  @Input('groupArrayName') groupArrayName: string;\n\n  noResults = false;\n\n  localSpinner = false;\n  @Output() filteredReturn = new EventEmitter<any>();\n\n  public filteredItems: any = [];\n  public searchForm: FormGroup;\n\n  constructor(fb: FormBuilder) {\n    this.searchForm = fb.group({\n      value: ''\n    });\n  }\n\n  ngOnInit() {\n    this.searchFormValueChangesSubscription =  this.searchForm.valueChanges.subscribe(value => {\n      if (this.showSpinner) {\n        this.localSpinner = true;\n      }\n      if (value['value']) {\n        // IF THE DISPLAY MEMBER INPUT IS SET WE CHECK THE SPECIFIC PROPERTY\n        if (this.displayMember == null) {\n          this.filteredItems = this.array.filter(name => name.toLowerCase().includes(value['value'].toLowerCase()));\n          // OTHERWISE, WE CHECK THE ENTIRE STRING\n        } else if (this.hasGroup && this.groupArrayName && this.displayMember) {\n          this.filteredItems = this.array.map(a => {\n            const objCopy = Object.assign({}, a);\n            objCopy[this.groupArrayName] = objCopy[this.groupArrayName].filter(g => g[this.displayMember].toLowerCase().includes(value['value'].toLowerCase()));\n            return objCopy;\n          }).filter(x => x[this.groupArrayName].length > 0);\n        } else {\n          this.filteredItems = this.array.filter(name => name[this.displayMember].toLowerCase().includes(value['value'].toLowerCase()));\n        }\n        // NO RESULTS VALIDATION\n\n        this.noResults = this.filteredItems == null || this.filteredItems.length === 0;\n\n\n      } else {\n        this.filteredItems = this.array.slice();\n        this.noResults = false;\n      }\n      this.filteredReturn.emit(this.filteredItems);\n      setTimeout(() => {\n        if (this.showSpinner) {\n          this.localSpinner = false;\n        }\n      }, 2000);\n    });\n\n    setTimeout(() => {\n      this.input.nativeElement.focus();\n    }, 500);\n    if (!this.placeholder) {\n      this.placeholder = 'Search...';\n    }\n  }\n\n  handleKeydown(event: KeyboardEvent) {\n    // PREVENT PROPAGATION FOR ALL ALPHANUMERIC CHARACTERS IN ORDER TO AVOID SELECTION ISSUES\n    if ((event.key && event.key.length === 1) ||\n      (event.keyCode >= A && event.keyCode <= Z) ||\n      (event.keyCode >= ZERO && event.keyCode <= NINE) ||\n      (event.keyCode === SPACE)) {\n      event.stopPropagation();\n    }\n  }\n  ngOnDestroy() {\n    this.filteredReturn.emit(this.array);\n    this.searchFormValueChangesSubscription.unsubscribe();\n  }\n}\n","import { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatSelectFilterComponent } from './mat-select-filter.component';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n@NgModule({\n  declarations: [MatSelectFilterComponent],\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    MatProgressSpinnerModule\n  ],\n  exports: [MatSelectFilterComponent]\n})\nexport class MatSelectFilterModule { }\n"]}